Please refer to the implementation in closed/Nvidia.
